<!DOCTYPE html>
<html lang="ja">
<head>
<meta http-equiv="Content-Language" content="ja" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<title>delta - フレームワーク入門 - はじめに</title>
<link href="../assets/css/base.css" rel="stylesheet" type="text/css" media="all" />


</head>
<body>


  <header>
          <div class="row">
        <div class="half">
          <a href="../index.html"><img src="../assets/images/logo.png" alt="delta" /></a>
        </div>
        <div class="half">
           <!--#include virtual="/global_assets/content/navi.php" -->
</div>
</div> 
    <h1 id="top">フレームワーク入門 - はじめに</h1>
  </header>
  <div id="contents"><article>
    <p class="right"><a href="../index.html">戻る</a><br />
      最終更新日: 2011 年 4 月 24 日</p>
    <h2>フレームワークの思想</h2>
    <p>delta は MVC モデルに基づいて設計された Web アプリケーションのためのフルスタックフレームワークです。開発が始まった 2006 年は PHP の世界でも様々なフレームワークが生まれました。当初社内で開発するアプリケーションにどのフレームワークを採用するか悩みましたが、その頃は PHP5 で拡張性が高く即戦力となるライブラリが見つからなかったため、会社設立と同時期にアプリケーションの基盤となる delta の開発が始まりました。</p>
    <p>delta の設計思想は今となってはやや古いですが、DI (依存性の注入) や、J2EE パターン、Martin Fowler 氏が提唱する PofEAA といったアーキテクチャが組み込まれています。delta はこれら既存の思想に加え、ビジネスアプリケーションを迅速に開発できるための基盤作りが目標となっています。 </p>
    <h2>主な特徴</h2>
    <p>フレームワークはモデルやビューの提供だけでなく、アプリケーション開発をサポートする様々なユーティリティメソッドを提供します。ここでは delta の特徴的な機能を一部紹介します。 </p>
    <dl>
      <dt>MVC モデル</dt>
      <dd>
        <p> 一般的な Web アプリケーションフレームワークで採用されている MVC モデルに準拠しています。ビジネスロジックをプログラムファイル、クライアントへのレスポンスをテンプレートファイルに集約させることにより、保守性の高いコードを保つことが可能になります。またモデルやビューに関してはあまり細かく制約を設けていないため、最低限の制約さえ守ればアプリケーション開発者が新しいルールを決めることも可能です。</p>
      </dd>
      <dt>URI ルーティング機能</dt>
      <dd>
        <p>Web アプリケーションはクライアントからリクエストされた URI によって実行するプログラムが決まります。一般的な PHP プログラムであれば、http://xxx/foo.php?bar=baz のような URI が送信されることによって、対象となるプログラムが起動しますが、delta は URI を解析するためのルーティング機能を搭載しているため、プログラムを実行するための URI を柔軟にカスタマイズすることが可能です。</p>
      </dd>
      <dt>DI コンテナ</dt>
      <dd>
        <p>DI  (Dependency Injection) とは「依存性の注入」と呼ばれるデザインパターンのことです。DI の概念や仕組みについては参考となるサイトで確認してもらうとして、delta には DI コンテナが実装されています。DI コンテナは、簡単に言えばオブジェクト間の依存関係を独立して管理するため、プログラムの変更や拡張が柔軟に実現できるようになります。フレームワークが提供するコンポーネントは DI コンテナから提供されているので、開発者は DI を特に意識する必要はありません。もちろん、プログラマが作成したコンポーネントを DI に登録したり呼び出すことも可能です。</p>
      </dd>
      <dt>YAML 形式の設定ファイル</dt>
      <dd>
        <p> アプリケーションの各種設定ファイルは YAML で記述します。YAML を知らない人は怖じけることはありません。YAML は構造化されたデータを表現するためのフォーマットの一種です。XML より分かりやすい構造のため、人間にとって読みやすいデータ形式です。類似の規格としては JSON が挙げられますが、昨今の AJAX ブームで聞いたことがある人も多いのではないでしょうか。(jQuery や YUI といったフレームワークもデータ形式には JSON を採用しています) YAML は設定ファイルのフォーマットとしても、「分かりやすい」、「書きやすい」というメリットがあるため、本フレームワークで採用しています。YAML の仕様について詳しく知りたい場合は <img src="../assets/images/icons/external.gif" alt="外部リンク" width="14" height="14" /> <a href="http://yaml.org/spec/1.0/">YAML Ain't Markup Language (YAML™) 1.0</a> を参照して下さい。</p>
      </dd>
      <dt>フィルタ機構</dt>
      <dd>
        <p>フィルタはクライアントからリクエストが発生する度に実行されるプログラムのことです。一つのアプリケーションに複数のフィルタを登録することができるため、一般的な利用法としては、ユーザ認証やロギングなどが考えられます。フィルタの適用範囲については開発者が決めることができます。delta にはあらかじめいくつかのフィルタ (BASIC 認証フィルタ、メンテナンスフィルタなど) が組み込まれているので参考にしてみると良いでしょう。</p>
      </dd>
      <dt>リクエストデータの検証</dt>
      <dd>
        <p>Web アプリケーションではクライアントから送信されたデータをサーバサイドで検証する必要がありますが、検証のためのロジックはどこに書けば良いでしょうか。できることであればビジネスロジックと検証コードは分離しておくべきです。ビジネスロジックに検証コードが含まれていると、コードの保守性が低下しやすいためです。delta にはフォームから入力されたデータを検証するためのバリデーション機構が備わっており、基本的な入力チェックは設定ファイルに検証ルールを定義するだけで自動的にエラーチェックを実行します。またバリデーション機構にはもう一つのメリットがあり、汎用的によく利用する検証ルールを設定ファイルに定義しておくことで、エラーメッセージのフォーマットや基本的なルールセットをアプリケーションレベルで共通化することができます。</p>
      </dd>
      <dt>リクエストデータの変換</dt>
      <dd>
        <p> クライアントから送信されるデータには開発者が想定していないコード (絵文字や機種依存文字など) が含まれる可能性があります。データのサニタイズをプログラムごとに書いていてはきりがないですし、場合によっては書き忘れることもあるでしょう。リクエストデータを開発者が意図した形式に変換する機構として、コンバート機能が備わっています。コンバート機能はデータのサニタイズ (余分な空白や機種依存文字を除去) や半角カナから全角カナへの変換など、一般的なデータとして望ましい形式にリクエストデータを変換してくれます。コンバート機能はバリデート機能同様に設定ファイルに定義することができます。</p>
      </dd>
      <dt>ビューの記述</dt>
      <dd>
        <p> MVC で言うところの View に当たる出力ですが、基本的には生の PHP タグで記述します。そもそも PHP という言語自体がテンプレート言語のようなものなので、書き方に関しては特に難しいことはないでしょう。また、プログラムと連携するフォームやリンクの生成に関してはヘルパを用意しているので、テンプレートコーダは PHP の基本的な構文とヘルパの使い方さえ理解していれば、プログラムの中身を意識することなくページをカスタマイズすることができます。また、プロジェクトによっては「Smarty を使って欲しい」といった要望があるかもしれません。delta には他のテンプレートフレームワークで慣れていた方のためにいくつかの有名なエンジン (Smarty、Twig、PHPTAL など) をサポートしています。フレームワークの変更は設定ファイルを一行書き換えるだけで済みます。</p>
      </dd>
    </dl>
    <dl>
      <dt>外部サービスとの連携</dt>
      <dd>
        <p>OpenID や OAuth といった外部認証サービスに対応しています。主要なプロバイダに対応しており、例えば OAuth に対応した Twitter からは、ユーザがツイートしたメッセージのストリームをアプリケーションに取り組むといった処理が簡単に実装できます。また日本発の mixi アプリにも対応しており、mixi との通信の部分は殆どフレームワークによってカプセル化されています。開発者はビジネスロジックに専念することができるため、効率的な開発が望めるでしょう。</p>
      </dd>
      <dt>エラーのロギング</dt>
      <dd>
        <p>アプリケーションでエラーが発生した場合、エラー内容は例外ハンドラに委譲され、スタックトレースを画面に出力したり、ログアペンダを経由してファイル出力やメール送信を行います。ログを取るためのロガーインスタンスはアプリケーション内のコードから呼び出すことができるため、デバッグ目的でログを取ることも可能です。delta が提供するロガーは強力な機構を持っているため、特定の例外や (開発者が設定した) ログのレベルのみロギングするといった制御も設定ファイル上で定義することが可能です。また、例外ハンドラはフィルタのようにチェーン構造になっているため、複数のハンドラを登録して連鎖的に例外をハンドリングすることもできます。</p>
      </dd>
      <dt>コンソールアプリケーションの開発</dt>
      <dd>
        <p> delta はコンソールアプリケーションの開発にも対応しているため、定期実行が必要なコンソールプログラムも Web アプリケーションを開発する時と同じ感覚でプログラムを組むことができます。作成したプログラムを cron やサービスに登録すれば、後はデーモンが自動的にプログラムを実行します。プログラム内でエラーが発生した場合も Web アプリケーション同様にロギング機構が働くので、例外ロジックの共通化が図れます。</p>
      </dd>
    </dl>
    <h2>その他の機能</h2>
    <p>delta には上で挙げた特徴以外にも、アプリケーション開発を手助けする様々な機能やユーティリティを提供します。詳しくはリファレンスや API を参照して下さい。</p>
    <ul>
      <li>トランザクショントークン: クライアントからの二重リクエスト送信を防止する</li>
      <li>セキュリティロール: ACL を用いたユーザの権限チェック</li>
      <li>メッセージ機構: イベントの成功通知やエラー通知のメッセージを一元管理</li>
      <li>設定ファイルの動的読み込み: サーバの環境 (ステージング、プロダクション環境等) に合わせて設定ファイルを動的に読み込む機構</li>
      <li>キャッシュ機構: APC、Memcache などのキャッシュエンジンをサポート</li>
      <li>クラスファイルの動的読み込み: クラスパスを宣言せずクラスを参照可能とする</li>
      <li>ユーティリティクラス: メール送信やページネーションなど、一般的によく利用する機能をパッケージ化</li>
      <li>汎用関数: 文字列や配列を操作するための汎用的な関数を提供</li>
      <li>テンプレートヘルパ: フォームやリンクの生成を手助けするヘルパクラスを提供</li>
    </ul>
    <p class="right"><a href="#top">上へ</a></p>
  </div>
  </div><footer>
    <p>Copyright &copy; delta framework project.</p>
  </footer>

</body>
</html>
